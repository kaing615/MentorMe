openapi: 3.0.0
info:
  title: MentorMe API Docs
  version: 1.0.0
  description: API documentation for MentorMe backend

servers:
  - url: http://localhost:4000/api/v1
    description: Development server

paths:
  /user/signup:
    post:
      tags:
        - Auth
      summary: Đăng ký tài khoản người dùng thường
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - userName
                - email
                - password
                - confirmPassword
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                userName:
                  type: string
                email:
                  type: string
                  format: email
                password:
                  type: string
                confirmPassword:
                  type: string
      responses:
        "201":
          description: Đăng ký thành công (vui lòng kiểm tra email xác thực)
        "400":
          description: Lỗi validate hoặc đăng ký thất bại

  /user/signupMentor:
    post:
      tags:
        - Auth
      summary: Đăng ký tài khoản mentor (có upload avatar)
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - userName
                - email
                - password
                - confirmPassword
                - jobTitle
                - location
                - category
                - skills
                - bio
                - mentorReason
                - greatestAchievement
                - avatar
              properties:
                firstName:
                  type: string
                lastName:
                  type: string
                userName:
                  type: string
                email:
                  type: string
                  format: email
                password:
                  type: string
                confirmPassword:
                  type: string
                jobTitle:
                  type: string
                location:
                  type: string
                category:
                  type: string
                skills:
                  type: array
                  items:
                    type: string
                bio:
                  type: string
                linkedinUrl:
                  type: string
                  format: uri
                mentorReason:
                  type: string
                greatestAchievement:
                  type: string
                introVideo:
                  type: string
                  format: uri
                avatar:
                  type: string
                  format: binary
      responses:
        "201":
          description: Đăng ký mentor thành công
        "400":
          description: Lỗi validate hoặc đăng ký thất bại

  /user/signin:
    post:
      tags:
        - Auth
      summary: Đăng nhập (cho cả mentor/mentee)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        "200":
          description: Đăng nhập thành công
        "400":
          description: Email hoặc mật khẩu không đúng

  /user/verify:
    get:
      tags:
        - Auth
      summary: Xác thực email từ link gửi về email
      parameters:
        - in: query
          name: email
          schema:
            type: string
          required: true
        - in: query
          name: verifyKey
          schema:
            type: string
          required: true
      responses:
        "200":
          description: Xác thực email thành công
        "400":
          description: Lỗi xác thực email

  /user/resend-verification-email:
    post:
      tags:
        - Auth
      summary: Gửi lại email xác thực
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
      responses:
        "200":
          description: Gửi lại email xác thực thành công
        "400":
          description: Không tìm thấy user hoặc đã xác thực

  /user/forgot-password:
    post:
      tags:
        - Auth
      summary: Yêu cầu đặt lại mật khẩu
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
      responses:
        "200":
          description: Đã gửi mail đặt lại mật khẩu (nếu user tồn tại)
        "400":
          description: Lỗi không tìm thấy user

  /user/reset-password:
    post:
      tags:
        - Auth
      summary: Đặt lại mật khẩu bằng token từ email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - token
                - newPassword
              properties:
                email:
                  type: string
                  format: email
                token:
                  type: string
                newPassword:
                  type: string
      responses:
        "200":
          description: Đặt lại mật khẩu thành công
        "400":
          description: Token không hợp lệ hoặc lỗi validate
<<<<<<< HEAD
=======

  # CREATE COURSE APIs
  /create-course:
    post:
      tags:
        - Create Course
      summary: Create a new course
      description: Create a new course with comprehensive details. Only mentors can create courses.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - price
                - category
                - level
                - numberOfLectures
                - courseOverview
                - keyLearningObjectives
              properties:
                title:
                  type: string
                  maxLength: 100
                  description: Course title
                  example: "Complete JavaScript Mastery Course"
                price:
                  type: number
                  minimum: 0
                  description: Course price in USD
                  example: 99.99
                category:
                  type: string
                  enum: [Programming, Design, Business, Marketing, Photography, Music, Health & Fitness, Language, Academic, Lifestyle]
                  description: Course category
                  example: "Programming"
                level:
                  type: string
                  enum: [Beginner, Intermediate, Advanced]
                  description: Course difficulty level
                  example: "Intermediate"
                numberOfLectures:
                  type: integer
                  minimum: 1
                  description: Total number of lectures
                  example: 25
                duration:
                  type: number
                  minimum: 0
                  description: Course duration in hours (optional)
                  example: 10.5
                courseOverview:
                  type: string
                  maxLength: 1000
                  description: Comprehensive overview of the course content
                  example: "This comprehensive JavaScript course will take you from beginner to advanced level. You'll learn modern ES6+ features, DOM manipulation, async programming, and build real-world projects."
                keyLearningObjectives:
                  type: string
                  maxLength: 500
                  description: Main learning objectives students will achieve
                  example: "Master JavaScript fundamentals, Build interactive web applications, Understand async programming, Work with APIs and databases"
                googleDriveMaterialsLink:
                  type: string
                  format: uri
                  description: Google Drive link for course materials (optional)
                  example: "https://drive.google.com/drive/folders/1234567890abcdef"
      responses:
        "201":
          description: Course created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Course created successfully"
                  course:
                    type: object
                    properties:
                      _id:
                        type: string
                        example: "64a1b2c3d4e5f6789012345"
                      name:
                        type: string
                        example: "Complete JavaScript Mastery Course"
                      description:
                        type: string
                        example: "This comprehensive JavaScript course..."
                      shortDescription:
                        type: string
                        example: "Master JavaScript fundamentals..."
                      price:
                        type: number
                        example: 99.99
                      category:
                        type: string
                        example: "Programming"
                      level:
                        type: string
                        example: "Intermediate"
                      lectures:
                        type: number
                        example: 25
                      duration:
                        type: number
                        example: 10.5
                      link:
                        type: string
                        example: "https://drive.google.com/drive/folders/..."
                      mentors:
                        type: array
                        items:
                          type: string
                        example: ["64a1b2c3d4e5f6789012348"]
                      createdAt:
                        type: string
                        format: date-time
                        example: "2024-01-01T10:00:00.000Z"
        "400":
          description: Invalid input data or validation failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Validation failed"
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        field:
                          type: string
                          example: "title"
                        message:
                          type: string
                          example: "Title is required"
        "401":
          description: Unauthorized - Token missing or invalid
        "403":
          description: Forbidden - Only mentors can create courses
        "500":
          description: Internal server error

  /create-course/form-data:
    get:
      tags:
        - Create Course
      summary: Get form configuration data
      description: Retrieve form configuration data including available categories, levels, and validation rules for creating a course.
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Form configuration data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  categories:
                    type: array
                    items:
                      type: string
                    example: ["Programming", "Design", "Business", "Marketing", "Photography", "Music", "Health & Fitness", "Language", "Academic", "Lifestyle"]
                  levels:
                    type: array
                    items:
                      type: object
                      properties:
                        value:
                          type: string
                        label:
                          type: string
                    example: [{"value": "Beginner", "label": "Beginner"}, {"value": "Intermediate", "label": "Intermediate"}, {"value": "Advanced", "label": "Advanced"}]
                  validation:
                    type: object
                    description: Validation rules for form fields
                    properties:
                      title:
                        type: object
                        properties:
                          maxLength:
                            type: number
                            example: 100
                          required:
                            type: boolean
                            example: true
                      price:
                        type: object
                        properties:
                          min:
                            type: number
                            example: 0
                          required:
                            type: boolean
                            example: true
                          type:
                            type: string
                            example: "number"
                      numberOfLectures:
                        type: object
                        properties:
                          min:
                            type: number
                            example: 1
                          required:
                            type: boolean
                            example: true
                          type:
                            type: string
                            example: "integer"
        "401":
          description: Unauthorized

  /create-course/my-courses:
    get:
      tags:
        - Create Course
      summary: Get my created courses
      description: Retrieve courses created by the current authenticated user with pagination support.
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 10
          description: Number of courses per page
        - name: status
          in: query
          schema:
            type: string
          description: Filter courses by status
      responses:
        "200":
          description: User's courses retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  courses:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                        name:
                          type: string
                        price:
                          type: number
                        category:
                          type: string
                        level:
                          type: string
                        lectures:
                          type: number
                        createdAt:
                          type: string
                          format: date-time
                  totalCourses:
                    type: integer
                    example: 25
                  totalPages:
                    type: integer
                    example: 3
                  currentPage:
                    type: integer
                    example: 1
        "401":
          description: Unauthorized

  /create-course/validate:
    post:
      tags:
        - Create Course
      summary: Validate course data
      description: Validate course data before actual submission to check for any validation errors.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                price:
                  type: number
                category:
                  type: string
                level:
                  type: string
                numberOfLectures:
                  type: integer
                duration:
                  type: number
                courseOverview:
                  type: string
                keyLearningObjectives:
                  type: string
                googleDriveMaterialsLink:
                  type: string
      responses:
        "200":
          description: Validation passed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Validation passed"
                  isValid:
                    type: boolean
                    example: true
        "400":
          description: Validation failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Validation failed"
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        field:
                          type: string
                          example: "title"
                        message:
                          type: string
                          example: "Title is required"
        "401":
          description: Unauthorized

  # COURSE MANAGEMENT APIs
  /courses/{courseId}:
    get:
      tags:
        - Courses
      summary: Get course details by ID
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course to get
      responses:
        "200":
          description: Course details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  course:
                    type: object
                    properties:
                      id:
                        type: string
                      title:
                        type: string
                      description:
                        type: string
                      category:
                        type: string
                      level:
                        type: string
                        enum: [Beginner, Intermediate, Advanced]
                      price:
                        type: number
                      duration:
                        type: number
                      prerequisites:
                        type: array
                        items:
                          type: string
                      objectives:
                        type: array
                        items:
                          type: string
                      createdAt:
                        type: string
                        format: date-time
        "404":
          description: Course not found

  /courses:
    post:
      tags:
        - Courses
      summary: Create a new course
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - description
                - category
                - level
                - price
                - duration
              properties:
                title:
                  type: string
                  minLength: 3
                  description: Course title
                description:
                  type: string
                  minLength: 10
                  description: Course description
                category:
                  type: string
                  description: Course category
                level:
                  type: string
                  enum: [Beginner, Intermediate, Advanced]
                  description: Course difficulty level
                price:
                  type: number
                  minimum: 0
                  description: Course price in VND
                duration:
                  type: number
                  minimum: 1
                  description: Course duration in hours
                prerequisites:
                  type: array
                  items:
                    type: string
                  description: Course prerequisites
                objectives:
                  type: array
                  items:
                    type: string
                  description: Course learning objectives
      responses:
        "201":
          description: Course created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Course created successfully"
                  course:
                    type: object
                    properties:
                      id:
                        type: string
                      title:
                        type: string
                      description:
                        type: string
                      category:
                        type: string
                      level:
                        type: string
                      price:
                        type: number
                      duration:
                        type: number
        "400":
          description: Invalid input or validation error
        "401":
          description: Unauthorized - Token required

  /courses/{courseId}/reviews:
    post:
      tags:
        - Courses
      summary: Add a review to a course
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course to add review to
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - rating
                - comment
              properties:
                rating:
                  type: number
                  minimum: 1
                  maximum: 5
                  description: Rating from 1 to 5 stars
                comment:
                  type: string
                  minLength: 5
                  description: Review comment
      responses:
        "201":
          description: Review added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Review added successfully"
                  review:
                    type: object
                    properties:
                      id:
                        type: string
                      userId:
                        type: string
                      userName:
                        type: string
                      courseId:
                        type: string
                      rating:
                        type: number
                      comment:
                        type: string
                      createdAt:
                        type: string
                        format: date-time
        "400":
          description: Invalid input or validation error
        "401":
          description: Unauthorized - Token required
        "404":
          description: Course not found

    get:
      tags:
        - Courses
      summary: Get all reviews for a course
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course to get reviews for
      responses:
        "200":
          description: Reviews retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  reviews:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        userId:
                          type: string
                        userName:
                          type: string
                        courseId:
                          type: string
                        rating:
                          type: number
                        comment:
                          type: string
                        createdAt:
                          type: string
                          format: date-time
        "404":
          description: Course not found

  /courses/{courseId}/mentors:
    post:
      tags:
        - Courses
      summary: Add a mentor to a course
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - mentorId
              properties:
                mentorId:
                  type: string
                  description: The ID of the mentor to add to course
      responses:
        "200":
          description: Mentor added to course successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Mentor added to course successfully"
        "400":
          description: Invalid input or mentor already in course
        "401":
          description: Unauthorized - Token required
        "404":
          description: Course or mentor not found

  /courses/{courseId}/mentors/{mentorId}:
    delete:
      tags:
        - Courses
      summary: Remove a mentor from a course
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course
        - in: path
          name: mentorId
          schema:
            type: string
          required: true
          description: The ID of the mentor to remove
      responses:
        "200":
          description: Mentor removed from course successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Mentor removed from course successfully"
        "400":
          description: Invalid input or mentor not in course
        "401":
          description: Unauthorized - Token required
        "404":
          description: Course or mentor not found

  /courses/{courseId}/content:
    post:
      tags:
        - Courses
      summary: Add content (lesson) to a course
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - content
                - type
              properties:
                title:
                  type: string
                  description: Content/lesson title
                content:
                  type: string
                  description: Content/lesson body
                type:
                  type: string
                  enum: [video, text, quiz, assignment]
                  description: Type of content
                duration:
                  type: number
                  description: Content duration in minutes
                order:
                  type: number
                  description: Content order in course
      responses:
        "201":
          description: Content added to course successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Content added to course successfully"
                  content:
                    type: object
                    properties:
                      id:
                        type: string
                      title:
                        type: string
                      content:
                        type: string
                      type:
                        type: string
                      duration:
                        type: number
                      order:
                        type: number
                      createdAt:
                        type: string
                        format: date-time
        "400":
          description: Invalid input or validation error
        "401":
          description: Unauthorized - Token required
        "404":
          description: Course not found

  /courses/{courseId}/content/{contentId}:
    delete:
      tags:
        - Courses
      summary: Remove content (lesson) from a course
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: courseId
          schema:
            type: string
          required: true
          description: The ID of the course
        - in: path
          name: contentId
          schema:
            type: string
          required: true
          description: The ID of the content to remove
      responses:
        "200":
          description: Content removed from course successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Content removed from course successfully"
        "401":
          description: Unauthorized - Token required
        "404":
          description: Course or content not found

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Auth
    description: User authentication and management APIs
  - name: Create Course
    description: APIs for creating new courses with comprehensive validation
  - name: Courses
    description: Course management APIs
>>>>>>> feature/courseCreate-BE
